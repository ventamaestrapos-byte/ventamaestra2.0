<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Empaquetador VentaMaestra</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #ff8c00 0%, #ff6600 100%);
      min-height: 100vh;
      padding: 20px;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      border-radius: 20px;
      padding: 40px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    h1 {
      color: #ff6600;
      text-align: center;
      margin-bottom: 30px;
      font-size: 2.5em;
    }
    .info {
      background: #fff3e6;
      border-left: 5px solid #ff6600;
      padding: 20px;
      margin: 20px 0;
      border-radius: 5px;
    }
    .button {
      display: inline-block;
      background: #ff6600;
      color: white;
      padding: 15px 30px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      margin: 10px 5px;
      transition: background 0.3s;
    }
    .button:hover {
      background: #ff8c00;
    }
    .progress {
      display: none;
      margin: 20px 0;
      padding: 20px;
      background: #f0f0f0;
      border-radius: 8px;
    }
    .log {
      background: #2d2d2d;
      color: #0f0;
      padding: 15px;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      max-height: 400px;
      overflow-y: auto;
      margin: 20px 0;
    }
    .success {
      background: #d4edda;
      border-left: 5px solid #28a745;
      padding: 20px;
      margin: 20px 0;
      border-radius: 5px;
      color: #155724;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üì¶ Empaquetador VentaMaestra</h1>
    
    <div class="info">
      <h3>üéØ ¬øQu√© hace esta herramienta?</h3>
      <p>Crea un archivo HTML √∫nico y port√°til que contiene TODA tu aplicaci√≥n:</p>
      <ul style="margin: 10px 0 0 20px;">
        <li>‚úÖ No necesita servidor</li>
        <li>‚úÖ Funciona offline completamente</li>
        <li>‚úÖ Se puede copiar a cualquier dispositivo</li>
        <li>‚úÖ Incluye todos los estilos y scripts</li>
        <li>‚úÖ Usa localStorage para guardar datos</li>
      </ul>
    </div>

    <div style="text-align: center; margin: 30px 0;">
      <button class="button" onclick="empaquetarApp()">üöÄ Crear Aplicaci√≥n Portable</button>
    </div>

    <div class="progress" id="progress">
      <h3>Procesando...</h3>
      <div class="log" id="log"></div>
    </div>

    <div class="success" id="success" style="display: none;">
      <h3>‚úÖ ¬°Aplicaci√≥n Creada Exitosamente!</h3>
      <p>Archivo: <strong>VentaMaestra-Portable.html</strong></p>
      <p>Puedes copiar este archivo a cualquier dispositivo y abrirlo directamente en el navegador.</p>
      <button class="button" onclick="descargarApp()">‚¨áÔ∏è Descargar Ahora</button>
    </div>
  </div>

  <script>
    let appPortable = '';
    
    function log(mensaje) {
      const logDiv = document.getElementById('log');
      logDiv.innerHTML += mensaje + '<br>';
      logDiv.scrollTop = logDiv.scrollHeight;
    }

    async function empaquetarApp() {
      document.getElementById('progress').style.display = 'block';
      document.getElementById('success').style.display = 'none';
      document.getElementById('log').innerHTML = '';
      
      log('üöÄ Iniciando empaquetado...');
      
      try {
        // Leer archivos
        log('üìñ Leyendo archivos CSS...');
        const styles = await fetch('styles.css').then(r => r.text());
        const naranjaTheme = await fetch('naranja-theme.css').then(r => r.text());
        
        log('üìñ Leyendo archivos JavaScript...');
        const licenciaJS = await fetch('licencia.js').then(r => r.text());
        const appJS = await fetch('app.js').then(r => r.text());
        const tiendaJS = await fetch('tienda.js').then(r => r.text());
        const productosJS = await fetch('productos.js').then(r => r.text());
        const inventariosJS = await fetch('inventarios.js').then(r => r.text());
        
        log('üìñ Leyendo p√°ginas HTML...');
        const tiendaHTML = await fetch('tienda.html').then(r => r.text());
        
        log('üîß Construyendo aplicaci√≥n portable...');
        
        // Crear aplicaci√≥n completa
        appPortable = `<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VentaMaestra 2.0 - Portable</title>
  <style>
${styles}

${naranjaTheme}
  </style>
</head>
<body>
  <div id="app-root"></div>

  <script>
// ===== LICENCIA.JS =====
${licenciaJS}

// ===== APP.JS =====
${appJS}

// ===== TIENDA.JS =====
${tiendaJS}

// ===== PRODUCTOS.JS =====
${productosJS}

// ===== INVENTARIOS.JS =====
${inventariosJS}

// ===== INICIALIZACI√ìN =====
window.addEventListener('DOMContentLoaded', function() {
  // Cargar contenido de tienda
  document.getElementById('app-root').innerHTML = \`${tiendaHTML.replace(/`/g, '\\`')}\`;
  
  // Inicializar aplicaci√≥n
  if (typeof initApp === 'function') {
    initApp();
  }
});
  </script>
</body>
</html>`;
        
        log('‚úÖ Aplicaci√≥n empaquetada correctamente');
        log('üìä Tama√±o: ' + (appPortable.length / 1024).toFixed(2) + ' KB');
        
        document.getElementById('success').style.display = 'block';
        
      } catch (error) {
        log('‚ùå ERROR: ' + error.message);
        console.error(error);
      }
    }

    function descargarApp() {
      const blob = new Blob([appPortable], { type: 'text/html' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'VentaMaestra-Portable.html';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
      
      log('‚¨áÔ∏è Descarga iniciada...');
    }
  </script>
</body>
</html>
